<!-- templates/admin_panel/order_detail.html -->
{% extends 'admin_panel/base.html' %}
{% block title %}Order #{{ order.order_id }}{% endblock %}
{% block page_title %}Order Details{% endblock %}
{% block content %}
<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem;">
    <div>
        <div class="admin-table-container" style="margin-bottom: 1.5rem;">
            <div class="admin-table-header"><h2>Order #{{ order.order_id }}</h2></div>
            <div style="padding: 1.5rem;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                    <div><strong>Order Date:</strong> {{ order.created_at|date:"F d, Y H:i" }}</div>
                    <div><strong>Customer:</strong> {{ order.user.username }}</div>
                    <div><strong>Email:</strong> {{ order.email }}</div>
                    <div><strong>Phone:</strong> {{ order.phone }}</div>
                </div>
                <div style="margin-bottom: 1.5rem;">
                    <strong>Delivery Address:</strong><br>
                    {{ order.first_name }} {{ order.last_name }}<br>
                    {{ order.address }}<br>
                    {{ order.city }}, {{ order.state }} {{ order.postal_code }}
                </div>
            </div>
        </div>
        <div class="admin-table-container">
            <div class="admin-table-header"><h2>Order Items</h2></div>
            <table class="admin-table">
                <thead><tr><th>Product</th><th>Price</th><th>Quantity</th><th>Total</th></tr></thead>
                <tbody>
                    {% for item in order.items.all %}
                    <tr>
                        <td>{{ item.product.name }}</td>
                        <td>${{ item.price }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>${{ item.total_price }}</td>
                    </tr>
                    {% endfor %}
                    <tr style="font-weight: bold; background-color: #f8f9fa;">
                        <td colspan="3" style="text-align: right;">Total:</td>
                        <td>${{ order.total_amount }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div>
        <div class="admin-table-container">
            <div class="admin-table-header"><h2>Update Status</h2></div>
            <div style="padding: 1.5rem;">
                <form method="post">
                    {% csrf_token %}
                    <div class="form-group">
                        <label class="form-label">Order Status</label>
                        <select name="status" class="form-control">
                            <option value="pending" {% if order.status == 'pending' %}selected{% endif %}>Pending</option>
                            <option value="confirmed" {% if order.status == 'confirmed' %}selected{% endif %}>Confirmed</option>
                            <option value="shipped" {% if order.status == 'shipped' %}selected{% endif %}>Shipped</option>
                            <option value="delivered" {% if order.status == 'delivered' %}selected{% endif %}>Delivered</option>
                            <option value="cancelled" {% if order.status == 'cancelled' %}selected{% endif %}>Cancelled</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-success" style="width: 100%;"><i class="fas fa-save"></i> Update Status</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div style="margin-top: 2rem;"><a href="{% url 'admin_panel:orders' %}" class="btn btn-primary"><i class="fas fa-arrow-left"></i> Back to Orders</a></div>
{% endblock %}