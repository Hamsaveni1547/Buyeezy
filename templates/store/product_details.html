<!-- templates/store/product_detail.html -->
{% extends 'base.html' %}

{% block title %}{{ product.name }} - E-Store{% endblock %}

{% block content %}
<nav class="breadcrumb">
    <div class="breadcrumb-item"><a href="{% url 'store:home' %}">Home</a></div>
    <div class="breadcrumb-item"><a href="{% url 'store:product_list' %}">Products</a></div>
    <div class="breadcrumb-item"><a href="{% url 'store:category' product.category.slug %}">{{ product.category.name }}</a></div>
    <div class="breadcrumb-item active">{{ product.name }}</div>
</nav>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; margin-bottom: 3rem;">
    <!-- Product Image -->
    <div>
        {% if product.image %}
            <img src="{{ product.image.url }}" alt="{{ product.name }}" style="width: 100%; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
        {% else %}
            <div style="width: 100%; height: 400px; background-color: #f0f0f0; display: flex; align-items: center; justify-content: center; border-radius: 10px; color: #999;">
                <i class="fas fa-image" style="font-size: 5rem;"></i>
            </div>
        {% endif %}
    </div>
    
    <!-- Product Info -->
    <div>
        <div style="color: #667eea; font-weight: 500; margin-bottom: 0.5rem;">{{ product.category.name }}</div>
        <h1 style="font-size: 2.5rem; margin-bottom: 1rem; color: #333;">{{ product.name }}</h1>
        <div style="font-size: 2rem; color: #28a745; font-weight: bold; margin-bottom: 2rem;">${{ product.price }}</div>
        
        <div style="margin-bottom: 2rem;">
            <h3 style="margin-bottom: 1rem;">Description</h3>
            <p style="line-height: 1.8; color: #666;">{{ product.description }}</p>
        </div>
        
        <div style="margin-bottom: 2rem;">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                <span style="font-weight: 500;">Stock:</span>
                {% if product.is_in_stock %}
                    <span style="color: #28a745; font-weight: 500;">{{ product.stock }} available</span>
                {% else %}
                    <span style="color: #dc3545; font-weight: 500;">Out of stock</span>
                {% endif %}
            </div>
        </div>
        
        {% if product.is_in_stock %}
            <div style="display: flex; gap: 1rem; margin-bottom: 2rem;">
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <label for="quantity" style="font-weight: 500;">Quantity:</label>
                    <input type="number" id="quantity" value="1" min="1" max="{{ product.stock }}" style="width: 80px; padding: 0.5rem; border: 2px solid #e9ecef; border-radius: 5px;">
                </div>
                {% csrf_token %}
                <button onclick="addToCart({{ product.id }}, document.getElementById('quantity').value)" class="btn btn-success" style="flex: 1;">
                    <i class="fas fa-cart-plus"></i> Add to Cart
                </button>
            </div>
        {% else %}
            <button class="btn btn-danger" style="width: 100%;" disabled>
                Out of Stock
            </button>
        {% endif %}
        
        <div style="border-top: 1px solid #eee; padding-top: 1rem; color: #666;">
            <p><i class="fas fa-truck"></i> Free shipping on orders over $50</p>
            <p><i class="fas fa-undo"></i> 30-day return policy</p>
            <p><i class="fas fa-shield-alt"></i> 1-year warranty</p>
        </div>
    </div>
</div>

<!-- Related Products -->
{% if related_products %}
<section>
    <h2 style="margin-bottom: 2rem;">Related Products</h2>
    <div class="product-grid">
        {% for product in related_products %}
        <div class="product-card">
            {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.name }}" class="product-image">
            {% else %}
                <div class="product-image" style="background-color: #f0f0f0; display: flex; align-items: center; justify-content: center; color: #999;">
                    <i class="fas fa-image" style="font-size: 3rem;"></i>
                </div>
            {% endif %}
            <div class="product-info">
                <div class="product-category">{{ product.category.name }}</div>
                <a href="{% url 'store:product_detail' product.slug %}" class="product-title">{{ product.name }}</a>
                <div class="product-price">${{ product.price }}</div>
                {% if product.is_in_stock %}
                    {% csrf_token %}
                    <button onclick="addToCart({{ product.id }})" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-cart-plus"></i> Add to Cart
                    </button>
                {% else %}
                    <button class="btn btn-danger" style="width: 100%;" disabled>
                        Out of Stock
                    </button>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}
{% endblock %}